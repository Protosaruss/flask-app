# --- Giriş Sayfası (Kullanıcı adıyla) ---
@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':  # Sadece form gönderildiyse çalışsın
        username = request.form.get('username')
        password = request.form.get('password')

        if not username or not password:
            flash("Lütfen tüm alanları doldurun.", "error")
            return redirect(url_for('login'))

        user = User.query.filter_by(username=username, password=password).first()
        if user:
            session['user'] = user.username
            flash("Başarıyla giriş yaptınız!", "success")
            return redirect(url_for('dashboard'))
        else:
            flash("Kullanıcı adı veya şifre hatalı.", "error")
            return redirect(url_for('login'))

    # Eğer GET isteğiyle geldiyse sadece login sayfasını render et
    return render_template('login.html')
